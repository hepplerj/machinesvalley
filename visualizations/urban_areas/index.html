---
title: Urban Areas of the San Francisco Peninsula 
date: 2014-09-10
permalink: /visualizations/urban_areas/
layout: visualization
---

<style>

svg {
  background: #7EC9C8;
}

path { fill: #fee6ce; }

.city-label {
  fill: #333;
  font-size: 12px;
  font-weight: 300;
  text-anchor: middle;
}

.subunit081 { fill: #F7F6F1; } /*#D2DDCC; }*/
.subunit075 { fill: #F7F6F1; } /*#dcd; }*/
.subunit085 { fill: #F7F6F1; } /*#cdd; }*/
.subunit087 { fill: #F7F6F1; } /*#DDCCDD; }*/
.subunit001 { fill: #F7F6F1; } /*#fde0dd; }*/

.subunit-boundary {
  fill: none;
  stroke: #777;
  stroke-dasharray: 2,2;
  stroke-linejoin: round;
}

.subunit-label {
  fill: #777;
  fill-opacity: .5;
  font-size: 20px;
  font-weight: 300;
  text-anchor: middle;
}
</style>

<h2>{{ page.title }}</h2>

<div id="map"></div>

  <div class="row">
    <div class="col-md-8">

      <h3>About the Map</h3>

      <p>
      After World War II, every municipality in the Bay Area underwent 
      aggressive expansion. Annexations, incorporations, and consolidations 
      sprawled throughout the Santa Clara Valley. The visualization above 
      shows the current urban areas on the San Francisco Peninsula. 
      </p>

      <h3>Citation</h3>
      <blockquote>
      Jason A. Heppler, "{{ page.title}}," interactive map, 
      {{site.url}}{{page.permalink}}, 2014.
      </blockquote>
    </div>

    <div class="col-md-4 sidebar">
      <h4>Data</h4>
      <ul>
        <li><a href="">Urban Areas GeoJSON</a></li>
      </ul>
    </div>
  </div>

<script>

queue()
  .defer(d3.json, "{{ site.url }}/visualizations/data/ca_counties.json")
  .defer(d3.json, "{{ site.url }}/visualizations/data/urban_areas_out.json")
  .await(ready);

var width = 1055,
    height = Math.max(500, window.innerHeight - 200),
    height = 500,
    margin = {left: 50, right: 50, bottom: 50, top: 50};

var color = d3.scale.category20();

var projection = d3.geo.albers()
    .center([0, 37.33])
    .rotate([121.9, 0])
    .parallels([50, 60])
    .scale(1200 * 45)
    .translate([width / 2, height / 2]);

var path = d3.geo.path()
    .projection(projection);

var svg = d3.select("#map").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom);

function ready(error, ca_counties, urban_areas) {
  if (error) return console.error(error);

  svg.selectAll(".subunit")
    .data(topojson.feature(ca_counties, ca_counties.objects.subunits).features)
  .enter().append("path")
    .attr("class", function(d) { return "subunit" + d.id; })
    .attr("d", path);

  svg.append("path")
    .datum(topojson.mesh(ca_counties, ca_counties.objects.subunits, function(a, b) { return a !== b }))
    .attr("d", path)
    .attr("class", "subunit-boundary");

  svg.selectAll(".urban_areas")
      .data(topojson.feature(urban_areas, urban_areas.objects.urban_areas).features)
    .enter().append("path")
      .style("fill", function(d,i) { return color(d.id); })
      .style("stroke", function(d,i) { return d3.lab(color(d.id)).darker(); })
      .attr("d", path)
      .style("opacity", "0.3");

  svg.selectAll(".city-label")
      .data(topojson.feature(urban_areas, urban_areas.objects.urban_areas).features)
    .enter().append("text")
      .attr("class", function(d) { return "city-label " + d.id; })
      .attr("transform", function(d) { return "translate(" + path.centroid(d) + ")"; })
      .attr("dy", ".35em")
      .text(function(d) { return d.properties.name; });

};

</script>
